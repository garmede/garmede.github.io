---
title: "유니티 셰이더 노출하기"
categories: [Blog]
tags: [셰이더, 유니티]
excerpt: "유니티에서 셰이더 파라미터를 사용할 수 있도록 외부로 노출하는 방법을 알아 봅니다."
# header:
#   overlay_image: /assets/images/blog/what-is-shader.webp
#   overlay_filter: 0.7
toc: true
toc_sticky: true
use_zoom: true
license: "CC BY-NC 4.0"
---
최적화 측면에서 한 프로그램이 셰이더의 종류가 매우 다양하다는 것은 그다지 좋은 상황이 아닙니다. 게임처럼 실시간으로 작동하는 분야에서는 더욱 문제가 될 여지가 커집니다. 하지만 다양한 효과를 써야 멋진 아트를 보여주기 좋겠죠.

그래서 엔진들은 하나의 셰이더를 다양하게 써먹을 수 있는 방법을 제시합니다. 엔진의 종류는 다양하지만 기본적인 테크닉은 대부분 비슷합니다. 아무래도 다른 엔진은 되는데 우리 엔진은 왜 안되냐 하는 이야기가 나오기 시작하면 엔진 회사 입장에서도 좋을게 없으니 안정적이고 다들 좋다고 하는 것은 얼추 구현해 놓기 마련입니다. 다만 엔진의 개발 철학이 달라 접근법이 다르다고 보는 것이 더 낫지 않을까 합니다.

**정보**<br/>꼭 한 셰이더를 다양하게 써야 최적화가 되는 것은 아닙니다. 최적화란 것이 쓰는 상황에 따라 늘 달라지기 쉽상입니다. 한 셰이더를 다양하게 쓰기 위해 `if`문이나 베리언츠로 덩치가 마구 마구 커지기 시작하면 그 또한 감당 안되는 상황이 올 수 있습니다.
{: .notice--info}

## 셰이더와 메테리얼 만들기

셰이더를 어떻게 돌아 가게 하는지도 중요하지만 개발을 혼자 하는 것이 아니라면 본인이 만든 셰이더를 다른 사람들이 잘 쓸 수 있게 하는 것도 중요합니다. 유니티는 그런 면에서 꽤 많은 파라미터를 제공해 주고 있습니다. 유니티에서는 이 파라미터들을 메테리얼을 통해 저장하기 때문에 프로퍼티(`Properties`)로 부르고 있습니다. 매우 간단한 방법으로 진행해 보죠. 일단 셰이더를 만들어 보겠습니다.

유니티의 프로젝트 윈도우에서 원하는 위치로 이동 후 오른클릭해서 **Create → Shader → Unlit Shader** 로 셰이더를 만듭니다.

![](/assets/images/blog/expose-shader-parameters-unity-new-shader.webp){: .zoom}

적당한 셰이더 파일 이름을 정해 주고, 만든 셰이더 파일을 오른클릭해서 **Create → Material** 로 해당 셰이더 파일을 사용하는 메테리얼을 만들어 보겠습니다.

![](/assets/images/blog/expose-shader-parameters-unity-new-material.webp){: .zoom}

**정보**<br/>이렇게 메테리얼과 셰이더를 꼭 함께 만들 필요는 없습니다. 이름도 얼마든지 마음껏 만들어도 괜찮습니다. 셰이더와 메테리얼 각자 필요한 위치에 만들어도 무관합니다. 메테리얼이 셰이더와 연결되어 있지 않다면 메테리얼을 선택후 인스펙터에서 다음과 같이 셰이더를 선택하면 됩니다.<br/>위 예제대로라면 **Unlit → NewUnlitShader**로 찾을 수 있습니다.<br/><br/>
![](/assets/images/blog/expose-shader-parameters-unity-shader-material.webp){: .align-center}
{: .notice--info}

## 셰이더 프로퍼티

만들어진 메테리얼을 선택해 보면 드디어 메테리얼 프로퍼티를 볼 수 있습니다.

![](/assets/images/blog/expose-shader-parameters-unity-material-properties.webp){: .align-center}

만들어진 셰이더 파일을 더블클릭해서 셰이더 파일을 수정해 보겠습니다.

**정보**<br/>일반적으로 셰이더 파일을 수정하려고 하면 VisualStudio가 실행될텐데 VisualStudio외에 다른 것을 사용해도 전혀 무관합니다. `.shader`파일은 단순 텍스트 파일이며, 텍스트만 수정할 수 있다면 메모장으로 작업하셔도 좀 불편하긴 해도 작성자체는 가능합니다. 편한 에디터를를 사용하세요!
{: .notice--info}

```hlsl
Shader "Unlit/NewUnlitShader"
{
    Properties
    {
        _MainTex ("Texture", 2D) = "white" {}
    }
    SubShader
    {
    ... 생략
    }
}
```

### 셰이더 프로퍼티 문법

제일 첫줄에 보이는 `Shader "이름" { ... }`은 유니티에서 셰이더라면 무조건 있어야 하는 부분입니다. `{`에서 `}`까지가 `"이름"`이 붙은 `Shader`라는 뜻으로 보면 되겠습니다.

이름은 스크립트와 다르게 파일명과 통일 시킬 필요가 없습니다. 큰 따옴표`"`로 잘 묶어 주기만 한다면 한글도 잘 작동합니다. 잘 작동하긴 하지만 프로그래머들은 싫어 할 수도 있습니다.:sweat_smile:

그 아래에 있는 `Properties { ... }` 구간이 유니티에서 파라미터를 노출시키는 부분입니다. 프로퍼티 구간밑으로는 일단 사용하지 않을테니 이 밑에서는 따로 표시하지 않겠습니다. 이제 남은 부분만을 가지고 실제 보이는 메테리얼에 어떻게 적용되는지 보면 다음과 같습니다.

![](/assets/images/blog/expose-shader-parameters-unity-properties01.webp){: .zoom}

위 이미지를 보면 각 부분이 유니티에서 어떻게 표현되고 있는지 아실 수 있을 것입니다. 좀 더 자세히 들여다 보겠습니다.

![](/assets/images/blog/expose-shader-parameters-unity-properties02.webp){: .zoom}

괄호나 `=`, `,`같은 기호들은 자리를 나눠주는 역할을 합니다. 각 부분의 역할은 다음과 같습니다.
- **변수 이름**: 이 이름을 통해 셰이더 안에서 사용할 이름입니다. 그러므로 다른 변수들과 이름이 *중복되어서는 안됩니다*.
- **프로퍼티 이름**: 유니티에 드러나는 이름입니다. 꽤 길게 써도 잘 나오지만 일반적으로 읽기 편하게 이 파라미터가 무엇인지만 간결하게 씁니다.
- **유형**: 이 프로퍼티가 어떤 유형인지 여기에 적은 대로 작동하게 됩니다.
- **기본 값**: 최초 메테리얼이 만들어 졌을 때 사용하는 값입니다. ***유형**에 따라 작성 방법이 다릅니다*.

**정보**<br/>텍스트 에디터에서 셰이더를 수정하고 저장한 다음 유니티에 오면 자동으로 적용이 됩니다. 혹시 안된다면 어딘가 문법이 틀린 부분이 있을 수 있습니다. 문제가 해결 되지 않는다면 인터넷을 찾아 보세요. 그래도 해결 되지 않으면 여기에 댓글을 한번 남겨 보시면 미천한 실력으로나마 혹시 어쩌면 도움을 드릴 수도 있습니다.:wink:
{: .notice--info}

## 셰이더 프로퍼티 유형

유니티에서 셰이더가 받을 수 있는 파라미터는 크게 **숫자**, **벡터**, **텍스처** 세가지 입니다. 그리고 각각 용도에 따라 프로퍼티를 다르게 설정할 수 있는데, 각 용도에 따라 유형을 구분 짓게 됩니다.

### 숫자

숫자란 말 그대로 숫자 하나를 의미합니다. 숫자 파라미터를 통해서 셰이더에 숫자 하나를 보낼 수 있습니다. 주로 속도, 밝기, 투명도, 세기 등 한가지를 조절하면 되는 용도의 파라미터로 사용하게 됩니다.

각자의 용도에 따라 여러가지 방법으로 설정할 수 있습니다.


